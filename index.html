<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  
    <title>Chord Diagram</title>
      </head>
    <style type="text/css">
        path {
            stroke: white;
            stroke-width: .1px;
        }

        path.fade {
            display: none;
        }

       svg {
            display: block;
            margin-left: auto;
            margin-right: auto;

        }
    </style>
  <div id="area1"></div>
  <div id="area2"></div>


<body>
    <h1>How </h1>
    <p>
  <a class="btn btn-primary" data-toggle="collapse" href="#area1" role="button" aria-expanded="false" aria-controls="collapseExample">
    Link with href
  </a>
  <button class="btn btn-primary" data-toggle="collapse" data="#area2" role = "button" aria-expanded="false" aria-controls="collapseExample">
    Button with data-target
  </button>
</p>
<div class="collapse" id="collapseExample">
  <div class="card card-body">
    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident.
  </div>
</div>
    
   
    <script src="js/d3.v5.min.js"></script>

    <script>
        var margin = {
                top: 10,
                right: 10,
                bottom: 10,
                left: 10
            },
            width = 700 - margin.left - margin.right,
            height = 800 - margin.top - margin.bottom,
            innerRadius = Math.min(width, height) * .35, //35% of smallest measurement
            outerRadius = innerRadius * 1.1; //110% of innerradius

        var bayarea = d3.select("#area1").append("svg")
            .attr("id", "bayarea")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .append("g")
            .attr("class", "chordgraph")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        d3.csv("bayarea.csv").then(function(d) {

            /*
             * IMPORTANT! Specify your first column of data here (see example data)
             *
             */
            var firstColumn = "first_column";

            //store column names
            var fc = d.map(function(d) {
                    return d[firstColumn];
                }),
                fo = fc.slice(0),
                maxtrix_size = (Object.keys(d[0]).length - 1) + fc.length,
                matrix = [];

            //Create an empty square matrix of zero placeholders, the size of the data
            for (var i = 0; i < maxtrix_size; i++) {
                matrix.push(new Array(maxtrix_size + 1).join('0').split('').map(parseFloat));
            }

            //go through the data and convert all to numbers except "first_column"
            for (var i = 0; i < d.length; i++) {

                var j = d.length; //counter

                for (var prop in d[i]) {
                    if (prop != firstColumn) {
                        fc.push(prop);
                        matrix[i][j] = +d[i][prop];
                        matrix[j][i] = +d[i][prop];
                        j++;
                    }
                }
            }

            //set color scale. More color options: https://github.com/d3/d3-scale-chromatic
            //  var color = d3.scaleOrdinal(d3.schemeAccent)
            var color = d3.scaleOrdinal(["#3182bd", "#de2d26", "#feb24c"])
            //d3 chord generator
            var chord = d3.chord()
                .padAngle(0.01)
                .sortSubgroups(d3.descending);

            //apply the matrix
            var chords = chord(matrix);

            //each ribbon generator
            var ribbon = d3.ribbon()
                .radius(innerRadius);

            //outer rim arc
            var arc = d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(innerRadius + 20);

            //add each of the groupings for outer rim arcs
            var group = bayarea.append("g")
                .selectAll("g")
                .data(chords.groups)
                .enter()
                .append("g");

            //add each outer rim arc path
            group.append("path")
                .attr("fill", function(d) {
                    return (d.index + 1) > fo.length ? color(d.index) : "#ccc";
                })
                .attr("stroke", function(d) {
                    return color(d.index);
                })
                .style("opacity", 0.8)
                .attr("d", arc)
                .style("cursor", "pointer")
                .on("mouseover", function(d, i) {
                    ribbons.classed("fade", function(d) {
                        return d.source.index != i && d.target.index != i;
                    });
                });

            //add each ribbon
            var ribbons = bayarea.append("g")
                .attr("fill-opacity", 0.7)
                .selectAll("path")
                .data(chords)
                .enter()
                .append("path")
                .attr("d", ribbon)
                .attr("fill", function(d) {
                    return color(d.target.index);
                })
                .attr("stroke", function(d) {
                    return d3.rgb(color(d.target.index)).darker();
                });

            //add the text labels
            group.append("text")
                .each(function(d) {
                    return d.angle = (d.startAngle + d.endAngle) / 2;
                })
                .attr("dy", ".35em")
                .attr("class", "text")
                .style("pointer-events", "none")
                .attr("text-anchor", function(d) {
                    return d.angle > Math.PI ? "end" : "start";
                })
                .attr("transform", function(d, i) {
                    console.log(fc[i], d);
                    //rotate each label around the circle           
                    return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")" +
                        "translate(" + (outerRadius + 10) + ")" +
                        (d.angle > Math.PI ? "rotate(180)" : "");

                })
                .text(function(d, i) {
                    //set the text content
                    return fc[i];
                })
                .style("font-family", "sans-serif")
                .style("font-size", "12px");
       
        });
        var southcoast = d3.select("#area2").append("svg")
            .attr("id", "southcoast")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
            .append("g")
            .attr("class", "chordgraph")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        d3.csv("southcoast.csv").then(function(d) {

            /*
             * IMPORTANT! Specify your first column of data here (see example data)
             *
             */
            var firstColumn = "first_column";

            //store column names
            var fc = d.map(function(d) {
                    return d[firstColumn];
                }),
                fo = fc.slice(0),
                maxtrix_size = (Object.keys(d[0]).length - 1) + fc.length,
                matrix = [];

            //Create an empty square matrix of zero placeholders, the size of the data
            for (var i = 0; i < maxtrix_size; i++) {
                matrix.push(new Array(maxtrix_size + 1).join('0').split('').map(parseFloat));
            }

            //go through the data and convert all to numbers except "first_column"
            for (var i = 0; i < d.length; i++) {

                var j = d.length; //counter

                for (var prop in d[i]) {
                    if (prop != firstColumn) {
                        fc.push(prop);
                        matrix[i][j] = +d[i][prop];
                        matrix[j][i] = +d[i][prop];
                        j++;
                    }
                }
            }

            //set color scale. More color options: https://github.com/d3/d3-scale-chromatic
            //  var color = d3.scaleOrdinal(d3.schemeAccent)
            var color = d3.scaleOrdinal(["#3182bd", "#de2d26", "#feb24c"])
            //d3 chord generator
            var chord = d3.chord()
                .padAngle(0.01)
                .sortSubgroups(d3.descending);

            //apply the matrix
            var chords = chord(matrix);

            //each ribbon generator
            var ribbon = d3.ribbon()
                .radius(innerRadius);

            //outer rim arc
            var arc = d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(innerRadius + 20);

            //add each of the groupings for outer rim arcs
            var group = southcoast.append("g")
                .selectAll("g")
                .data(chords.groups)
                .enter()
                .append("g");

            //add each outer rim arc path
            group.append("path")
                .attr("fill", function(d) {
                    return (d.index + 1) > fo.length ? color(d.index) : "#ccc";
                })
                .attr("stroke", function(d) {
                    return color(d.index);
                })
                .style("opacity", 0.8)
                .attr("d", arc)
                .style("cursor", "pointer")
                .on("mouseover", function(d, i) {
                    ribbons.classed("fade", function(d) {
                        return d.source.index != i && d.target.index != i;
                    });
                });

            //add each ribbon
            var ribbons = southcoast.append("g")
                .attr("fill-opacity", 0.7)
                .selectAll("path")
                .data(chords)
                .enter()
                .append("path")
                .attr("d", ribbon)
                .attr("fill", function(d) {
                    return color(d.target.index);
                })
                .attr("stroke", function(d) {
                    return d3.rgb(color(d.target.index)).darker();
                });

            //add the text labels
            group.append("text")
                .each(function(d) {
                    return d.angle = (d.startAngle + d.endAngle) / 2;
                })
                .attr("dy", ".35em")
                .attr("class", "text")
                .style("pointer-events", "none")
                .attr("text-anchor", function(d) {
                    return d.angle > Math.PI ? "end" : "start";
                })
                .attr("transform", function(d, i) {
                    console.log(fc[i], d);
                    //rotate each label around the circle           
                    return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")" +
                        "translate(" + (outerRadius + 10) + ")" +
                        (d.angle > Math.PI ? "rotate(180)" : "");

                })
                .text(function(d, i) {
                    //set the text content
                    return fc[i];
                })
                .style("font-family", "sans-serif")
                .style("font-size", "12px");
       
        });
        
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <p>how</p>
</body></html>